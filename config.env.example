# Discourse Link Archiver - Configuration for systemd service
# Copy this file to /opt/discourse-link-archiver/config.env and fill in your values

# =============================================================================
# RSS Feed Configuration
# =============================================================================
RSS_URL=https://discuss.criticalfallibilism.com/posts.rss
POLL_INTERVAL_SECS=60
CACHE_WINDOW_SECS=3600

# =============================================================================
# Database
# =============================================================================
DATABASE_PATH=/opt/discourse-link-archiver/data/archive.sqlite

# =============================================================================
# S3 Storage
# =============================================================================
# Your S3 bucket name (required)
S3_BUCKET=your-bucket-name

# AWS region (default: us-east-1)
S3_REGION=us-east-1

# Custom S3 endpoint for MinIO, Cloudflare R2, etc. (optional)
# S3_ENDPOINT=https://your-endpoint.com

# Prefix for all S3 keys (default: archives/)
S3_PREFIX=archives/

# AWS credentials (required)
AWS_ACCESS_KEY_ID=your-access-key-id
AWS_SECRET_ACCESS_KEY=your-secret-access-key

# =============================================================================
# Archive Workers
# =============================================================================
WORKER_CONCURRENCY=4
PER_DOMAIN_CONCURRENCY=1
WORK_DIR=/opt/discourse-link-archiver/data/tmp
YT_DLP_PATH=/opt/discourse-link-archiver/bin/yt-dlp
GALLERY_DL_PATH=/opt/discourse-link-archiver/bin/gallery-dl

# Path to cookies.txt for authenticated downloads (optional)
# COOKIES_FILE_PATH=/opt/discourse-link-archiver/cookies.txt

# Optional: use a persisted browser profile instead of exporting cookies.txt.
# Example: chromium+basictext:/app/cookies/chromium-profile
# YT_DLP_COOKIES_FROM_BROWSER=

# =============================================================================
# Archive Policy
# =============================================================================
# Archive mode: 'deletable' (only sites known for deletions) or 'all'
ARCHIVE_MODE=deletable

# Whether to archive links that only appear in quotes
ARCHIVE_QUOTE_ONLY_LINKS=false

# =============================================================================
# Web Server
# =============================================================================
WEB_HOST=0.0.0.0
WEB_PORT=8080

# =============================================================================
# Wayback Machine Integration
# =============================================================================
WAYBACK_ENABLED=true
WAYBACK_RATE_LIMIT_PER_MIN=5

# =============================================================================
# Database Backup
# =============================================================================
BACKUP_ENABLED=true
BACKUP_INTERVAL_HOURS=24
BACKUP_RETENTION_COUNT=30

# =============================================================================
# Logging
# =============================================================================
RUST_LOG=info,discourse_link_archiver=debug
